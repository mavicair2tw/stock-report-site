<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>台股新聞</title>
    <style>
      :root { --bg:#0b1020; --panel:#121a2f; --line:#1f2a44; --text:#e6edf3; --muted:#9fb0c3; }
      *{box-sizing:border-box}
      body{margin:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:linear-gradient(180deg,#0b1020 0%,#0a1226 100%);color:var(--text)}
      .wrap{max-width:1000px;margin:0 auto}
      .sub{color:var(--muted);margin-bottom:12px}
      .card{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:14px;line-height:1.7;margin-bottom:12px}
      .spotify-wrap{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:10px;margin-bottom:12px}
      .spotify-wrap iframe{border-radius:10px}
      a{color:#93c5fd}
    
      .yt-wrap{margin-top:14px;background:var(--panel);border:1px solid #1f2a44;border-radius:12px;padding:10px}
      .yt-wrap iframe{width:100%;max-width:100%;border-radius:10px}
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>台股新聞</h1>
      <div class="sub" id="updated">載入中...</div>
      <div class="sub" id="viewCounter">點閱數：--</div>

      <div class="spotify-wrap">
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/artist/3wNssuAFgx8ozrfBEsgCMs?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
      </div>
      <div class="card" id="summary">載入摘要中...</div>
      <div class="card">
        <h3 style="margin-top:0">新聞清單</h3>
        <ol id="list"></ol>
      </div>

      <div class="yt-wrap">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/videoseries?si=hWOb5m1mrNkGwuje&amp;list=PL-RVg4ur4a0R3Ys9uNd-5zjgslHjZteJQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
      </div>

    </div>

    <script>

      const pageKey = `views:${location.pathname}`;
      const pageViews = Number(localStorage.getItem(pageKey) || '0') + 1;
      localStorage.setItem(pageKey, String(pageViews));
      const viewCounterEl = document.getElementById('viewCounter');
      if (viewCounterEl) viewCounterEl.textContent = `點閱數：${pageViews}`;

      fetch('./data/tw_news.json?ts='+Date.now())
        .then(r=>r.json())
        .then(d=>{
          document.getElementById('updated').textContent = `更新時間：${d.updatedAt} (${d.timezone})`;
          document.getElementById('summary').innerHTML = `來源：<a href="${d.source}" target="_blank">cnyes 台股</a><br>${d.summary}`;
          const list = document.getElementById('list');
          list.innerHTML = (d.headlines||[]).map(h=>`<li><a href="${h.url}" target="_blank">${h.title}</a></li>`).join('') || '<li>目前無資料</li>';
        })
        .catch(()=>{
          document.getElementById('updated').textContent = '載入失敗';
        });
    </script>
  </body>
</html>
